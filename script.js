const termsText = `Terms of Service ("Terms")
Last updated: 15/09/2024

Please read these Terms of Service ("Terms", "Terms of Service") carefully before using Nyatastic (the "Service") operated by Catgirls Corporation ("us", "we", or "our").

Your access to and use of the Service is conditioned on your acceptance of and compliance with these Terms. These Terms apply to all visitors, users, and others who access or use the Service.

By accessing or using the Service, you agree to be bound by these Terms. If you disagree with any part of the terms, then you may not access the Service.

Data Collection
We only collect Discord User IDs and the command usage for leaderboard. We do not sell your data to third parties as per PDPA (Personal Data Protection Act).

Our Service also collects data you sent to our AI Chatbot, this is for memory capabilities. The chat you have with our Chatbot will be ENCRYPTED with AES algorithm.
Our ChatBot will collect the following data:
1) Chat ID ("UUID")
2) Chat Messages (Encrypted)
3) User ID (to associate the UUID to your account)
4) AI Response associated to your UUID

When you access our website, nekogirl.net, or parts of our Service, Cloudflare will log down your IP Address to determine if you are a robot or if you are part of a DDoS Botnet. Cloudflare might block your IP if you trigger their Cybersecurity solutions.

AI Chatbot
When you use our Service's Chatbot, you are bound to that your chat logs will be stored until the time you decide to delete them. If we have evidence of you abusing, or breaking Nyatastic's Terms or Privacy Policy, you will be indefinitely blacklisted from using our Service, till you make a support ticket in our Support server, shall we determine if you should be remove from the blacklist under our discrection.

Chatbot Limitations: 
We will permanently blacklist you from all of Nyatastic's services, shall we detect any fraudulent use of our Service. Including but not limited to:
1. Attempts to retrieve the Chatbot's System Prompt
2. Usage of the Chatbot for illegal activities or purposes that violate Nyatastic's Terms or applicable laws.
3. Attempts to overload or disrupt the Chatbot's functionality or infrastructure through malicious activities such as denial-of-service attacks.
4. Any other actions deemed by Nyatastic to be in violation of its policies or detrimental to its services or reputation.
5. Attempts to use DAN or LLM Jailbreaking on Nyatastic's Chatbot Service to gain unauthorized access to outside of it's intended purposes.

Please make sure you follow Discord's Terms and Community Guidelines when using the Chatbot, any mishaps that happens to your account when you use the Chatbot will not be under the responsibility of Catgirls Corporation.

Refunds
Refunds are handled on a case-by-case basis. Typically, we do not offer refunds for Pay-As-You-Use Services. Note that if you have used at least $0.10 of your purchased credits, you are INELIGIBLE for a refund.

APIs
The APIs we use are available to the public, and you can use our API if you wish at https://api.nekogirl.net/.

Third-Party Links and Services
Our bot may contain links to third-party web sites or services that are not owned or controlled by Catgirls Corporation.

Our domain name is nekogirl.net. Some of the domains listed might have subdomains such as api, rdct or go.

We will not be responsible for any third-party actions taken on your account. Please contact the respective party for the actions taken on you.

Intellectual Property
The logo and any pictures related to Nyatastic are strictly copyrighted. Please contact us at ip@jhh.moe if you have any inquiry about our bot.

Changes
We reserve the right, at our sole discretion, to modify or replace these Terms at any time. It is your responsibility to periodically check our Terms of Service for any changes. We may notify you of any changes by posting the new Terms of Service on this page or via other communication methods.

It is also your responsibility to periodically check our Terms of Service, as minor updates will NOT be announced.

Contact Us
If you have any questions about these Terms, please contact us at support@jhh.moe or on our support server.`;

const privacyText = `Privacy Policy
Last updated: 28/05/2024

Catgirls Corporation ("us", "we", or "our") operates Nyatastic (the "Service"). This page informs you of our policies regarding the collection, use, and disclosure of Personal Information when you use our Service.

We will not use or share your information with anyone except as described in this Privacy Policy.

We use your Personal Information only for providing and improving the Service. By using the Service, you agree to the collection and use of information in accordance with this policy.

Information Collection And Use
While using our Service, we may ask you to provide us with certain personally identifiable information that can be used to contact or identify you. Personally identifiable information may include, but is not limited to, your Discord User ID ("Personal Information").

We only collect Discord User IDs and the command usage for leaderboard purposes. We do not sell your data to third parties as per the PDPA (Personal Data Protection Act).

Log Data
We collect information that your browser sends whenever you visit our Service ("Log Data"). This Log Data may include information such as your computer's Internet Protocol ("IP") address, browser type, browser version, the pages of our Service that you visit, the time and date of your visit, the time spent on those pages, and other statistics.

Catgirls Corporation will NOT share or sell your data to Data Brokers. We dislike Data Brokers as much as you do.

We log every suggestion you send via our Service or by our support server. Please note that we reserve the right to blacklist you from using our Service if we find anything that is deemed rule-breaking under our discretion or violating Discord's TOS and Privacy Policy.

Cookies
Cookies are files with a small amount of data that is commonly used as an anonymous unique identifier. These are sent to your browser from the website that you visit and are stored on your computer's hard drive.

Our website uses these cookies to collect information and to improve our Service. You have the option to either accept or refuse these cookies and know when a cookie is being sent to your computer. If you choose to refuse our cookies, you may not be able to use some portions of our Service.

Service Providers
We may employ third-party companies and individuals to facilitate our Service, to provide the Service on our behalf, to perform Service-related services, or to assist us in analyzing how our Service is used.

These third parties may have access to your Personal Information only to perform these tasks on our behalf and are obligated not to disclose or use it for any other purpose.

AI Chatbot Data Collection
Our Service collects data you send to our AI Chatbot for memory capabilities. The chat you have with our Chatbot will be ENCRYPTED with the AES algorithm. Our ChatBot will collect the following data:
1. Chat ID ("UUID")
2. Chat Messages (Encrypted)
3. User ID (to associate the UUID to your account)
4. AI Response associated with your UUID

Cloudflare Data Collection
When you access our website, nekogirl.net, or parts of our Service, Cloudflare will log your IP Address to determine if you are a robot or part of a DDoS Botnet. Cloudflare might block your IP if you trigger their Cybersecurity solutions.

Links to Other Sites
Our Service may contain links to other sites that are not operated by us. If you click on a third-party link, you will be directed to that third party's site. We strongly advise you to review the Privacy Policy of every site you visit.

We have no control over and assume no responsibility for the content, privacy policies, or practices of any third-party sites or services.

Children's Privacy
Our Service does not address anyone under the age of 13 ("Children"). Please note that you MUST be 13 and above to use the bot, as per Discord Terms of Service/Usage.

We do not knowingly collect personally identifiable information from anyone under the age of 13. If you are a parent or guardian and you are aware that your child has provided us with Personal Information, please contact us at data@jhh.moe. If we become aware that we have collected Personal Information from Children without verification of parental consent, we will take steps to remove that information from our servers.

Changes to This Privacy Policy
We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page.

You are advised to review this Privacy Policy periodically for any changes. Changes to this Privacy Policy are effective when they are posted on this page.

Contact Us
If you have any questions about this Privacy Policy, please contact us at support@jhh.moe or join our Discord server.`;

const finalRedirectUrl = "https://go.nekogirl.net/invite-nyatastic";

const pageTitle = document.getElementById('page-title');
const overlayText = document.getElementById('overlay-text');
const inputText = document.getElementById('input-text');
const submitButton = document.getElementById('submit-button');
const message = document.getElementById('message');

let currentStage = 'terms'; 
let currentIndex = 0;
let errors = new Set();
let typedCharacters = new Set(); 

overlayText.innerText = termsText;

document.addEventListener('keydown', (event) => {
  if (event.code === 'Space') {
    event.preventDefault();
  }
});

function updateOverlayDisplay() {
  const requiredText = currentStage === 'terms' ? termsText : privacyText;
  
  const updatedText = requiredText.split('').map((char, index) => {
    if (typedCharacters.has(index)) {
      if (errors.has(index)) {
        if (char === ' ') {
          return `<span style="opacity: 1; color: red; background-color: rgba(255, 0, 0, 0.2);">·</span>`;
        }
        return `<span style="opacity: 1; color: red;">${char}</span>`;
      }
      return char === ' ' ? `<span style="opacity: 1;">·</span>` : `<span style="opacity: 1;">${char}</span>`;
    } 
    return char === ' ' ? `<span style="opacity: 0.5;">·</span>` : `<span style="opacity: 0.5;">${char}</span>`;
  }).join('');

  if (currentIndex === 0) {
    overlayText.innerHTML = `<span class="cursor"></span>${updatedText}`;
  } else if (currentIndex === requiredText.length) {
    overlayText.innerHTML = updatedText + '<span class="cursor"></span>';
  } else {
    const insertPosition = updatedText.split('</span>').slice(0, currentIndex).join('</span>').length + 7;
    overlayText.innerHTML = updatedText.slice(0, insertPosition) + 
                           '<span class="cursor"></span>' + 
                           updatedText.slice(insertPosition);
  }
}

function resetInput() {
  inputText.innerText = '';
  currentIndex = 0;
  errors.clear();
  typedCharacters.clear();
  updateOverlayDisplay();
  submitButton.disabled = true;
  message.innerText = '';
}

document.addEventListener('keydown', (event) => {
  const requiredText = currentStage === 'terms' ? termsText : privacyText;

  if (event.key === 'Enter') {
    event.preventDefault();
    if (requiredText[currentIndex] === '\n') {
      inputText.innerText += '\n';
      typedCharacters.add(currentIndex);
      currentIndex++;
      updateOverlayDisplay();
    }
    return;
  }

  if (event.key === 'Backspace' && currentIndex > 0) {
    event.preventDefault();
    inputText.innerText = inputText.innerText.slice(0, -1);
    currentIndex--;
    errors.delete(currentIndex);
    typedCharacters.delete(currentIndex);
    updateOverlayDisplay();
    return;
  }

  if (event.key.length === 1 && currentIndex < requiredText.length) {
    event.preventDefault();
    
    const currentChar = requiredText[currentIndex]; 

    if (event.key === currentChar) {
      inputText.innerText += event.key;
      typedCharacters.add(currentIndex);
      errors.delete(currentIndex);
      currentIndex++;
    } else {
      inputText.innerText += event.key;
      errors.add(currentIndex); 
      typedCharacters.add(currentIndex); 
      currentIndex++;
    }

    updateOverlayDisplay();

    if (currentIndex === requiredText.length && errors.size === 0) {
      submitButton.disabled = false;
    } else {
      submitButton.disabled = true;
    }

    if (errors.size > 0) {
      message.innerText = 'Please correct the highlighted errors to continue.\n(Retype the word after backspacing and this error will be removed.)';
    } else {
      message.innerText = '';
    }
  }
});

submitButton.addEventListener('click', () => {
  if (currentStage === 'terms') {
    currentStage = 'privacy';
    pageTitle.innerText = 'Privacy Policy';
    overlayText.innerText = privacyText;
    resetInput();
  } else if (currentStage === 'privacy') {
    window.location.href = finalRedirectUrl;
  }
});

document.addEventListener('keypress', (event) => {
  if (event.code === 'Space') {
    event.preventDefault();
  }
});

updateOverlayDisplay();

document.addEventListener('click', () => {
  inputText.focus();
});